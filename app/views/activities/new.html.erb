<div class="p-6 min-w-[32rem]" up-main>
  <h2 class="font-display text-xl text-gray-900 mb-5">Log Activity</h2>

  <%= form_with model: @activity, url: activities_path,
        html: { "up-target" => "[up-main]" },
        class: "space-y-4" do |f| %>

    <%# Contact picker %>
    <div>
      <%= f.label :contact_id, "Contact", class: "block text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1.5" %>
      <%= f.select :contact_id,
            @contacts.map { |c| [c.full_name, c.id] },
            { prompt: "Select a contact..." },
            class: "form-input w-full px-3 py-2 text-sm border border-gray-200 rounded-lg bg-surface-raised" %>
      <% if @activity.errors[:contact].any? %>
        <p class="text-xs text-red-600 mt-1"><%= @activity.errors[:contact].first %></p>
      <% end %>
    </div>

    <%# Activity kind segmented control â€” wired up by the up.compiler in application.js %>
    <div>
      <label class="block text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1.5">Type</label>
      <div class="flex gap-1 p-1 bg-surface-muted rounded-lg" id="activity-kind-selector">
        <% Activity::KINDS.each do |kind| %>
          <button type="button"
                  data-kind="<%= kind %>"
                  class="kind-btn flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md transition-all text-gray-500 hover:text-gray-700">
            <%= kind == 'note' ? 'ðŸ“' : kind == 'call' ? 'ðŸ“ž' : 'âœ‰ï¸' %>
            <%= kind.capitalize %>
          </button>
        <% end %>
      </div>
      <%= f.hidden_field :kind, value: "note" %>
    </div>

    <%# Body %>
    <div>
      <%= f.label :body, "Notes", class: "block text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1.5" %>
      <%= f.text_area :body,
            placeholder: "Describe the activity...",
            rows: 4,
            autocomplete: "off",
            class: "form-input w-full px-3 py-2 text-sm border border-gray-200 rounded-lg bg-surface-raised resize-none" %>
      <% if @activity.errors[:body].any? %>
        <p class="text-xs text-red-600 mt-1"><%= @activity.errors[:body].first %></p>
      <% end %>
    </div>

    <div class="flex justify-end gap-2 pt-1">
      <button type="button" up-dismiss
              class="px-4 py-2 text-sm text-gray-500 hover:text-gray-700 transition-colors">
        Cancel
      </button>
      <%= f.submit "Log Activity",
            class: "px-4 py-2 text-sm font-medium text-accent bg-accent/10 rounded-lg hover:bg-accent/20 cursor-pointer transition-colors" %>
    </div>

  <% end %>
</div>
