<%# Activity detail — opens as a modal or drawer overlay %>
<div class="px-6 pt-9 pb-6 min-w-[32rem]" up-main>

  <%# Header: kind icon + meta + actions %>
  <div class="flex items-start justify-between gap-4 mb-5">

    <div class="flex items-center gap-3">
      <%# Kind dot (reuses the timeline dot style, scaled up) %>
      <div class="w-10 h-10 rounded-xl flex items-center justify-center text-white flex-shrink-0"
           style="background: #d4976a;">
        <% case @activity.kind %>
        <% when "call" %>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.79 19.79 0 0 1 2.12 4.11 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
        <% when "email" %>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
        <% else %>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/></svg>
        <% end %>
      </div>

      <div>
        <p class="text-base font-semibold text-gray-900 capitalize"><%= @activity.kind %></p>
        <div class="flex items-center gap-1.5 mt-0.5">
          <span class="text-[11px] text-gray-400"><%= @activity.created_at.strftime("%B %-d, %Y · %-I:%M %p") %></span>
          <span class="text-[11px] text-gray-300">·</span>
          <%# Link to contact — shatters all overlays and navigates %>
          <%= link_to @activity.contact.full_name,
                contact_path(@activity.contact),
                "up-target" => "#contact-detail",
                "up-layer"  => "shatter",
                class: "text-[11px] text-accent hover:underline font-medium transition-colors" %>
        </div>
      </div>
    </div>

    <%# Edit + Delete actions %>
    <div class="flex items-center gap-2 flex-shrink-0">
      <%# Edit opens a new modal stacked on top; accepting it accepts this overlay too %>
      <%= link_to edit_activity_path(@activity),
            "up-target"  => "[up-main]",
            "up-history" => "false",
            class: "btn-ghost h-9 px-3 text-sm gap-1.5" do %>
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
        Edit
      <% end %>

      <%# Delete from overlay: destroy accepts this overlay; opener reloads the list %>
      <%= button_to activity_path(@activity), method: :delete,
            "up-confirm" => "Delete this activity? This cannot be undone.",
            class: "w-9 h-9 flex items-center justify-center rounded-lg text-red-400 hover:text-red-600 hover:bg-red-100 border-0 cursor-pointer transition-colors",
            title: "Delete" do %>
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
      <% end %>
    </div>
  </div>

  <%# Activity body %>
  <div class="bg-surface-muted rounded-xl p-4">
    <p class="text-sm text-gray-700 leading-relaxed whitespace-pre-wrap"><%= @activity.body %></p>
  </div>


</div>
